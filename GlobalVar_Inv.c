/*  
* target:invertor PWM variable initiation   
* Copyright 2018,4,16 IEE, Inc. 
* description:  the goal is to use invertor control funtion 
* function: 
* debug: 
* modification history:20180426 by wxx
*/
#include "vxWorks.h"
#include "GlobalVar_Inv.h"

 
/********************************************************************/

/*
double T1PRHalfSVM = 20834;
double T1PRHalfSHE = 6944;  */
int count_test = 0;
/* double  Ts = 2.777778e-4;  */
/* double  T1PR = T1PRSVM; *//*83334;*/  
/* double  T1PRHalf = T1PRHalfSVM;  */
 

double  Kv = 0.000;  
double  VVVF_Gama = 0;
int     SVM_VME_Flag = 0;  /*  Flag for ChangeTsSVM Func,To avoid frequent VME writting, writing enable when 0 */
int     SHE_VME_Flag = 0;  /*  Flag for ChangeTsSHE Func,To avoid frequent VME writting, writing enable when 0 */
short   IntFlagHF = 2,IntFlagHFInv = 2;  /* Dont Initialized to be 0*/
/* short   IntFlag = 0;  */

/*test Flags*/
int updateCMPA = 0;
int EvenOdd[6] = {2,2,2,2,2,2};
int SHEShutFlag_YN = 2;
int PsblupDateCMPA[6] = {0,0,0,0,0,0};

/*PWM Varis and Defination*/
double Gama_SVM;
int Sector_Num  = 0; 
int Region_Num  = 0;
int Sector_Num_Pre  = 0; 
int Region_Num_Pre  = 0;

double epwm1cmpa,epwm2cmpa,epwm3cmpa,epwm4cmpa,epwm5cmpa,epwm6cmpa;
double epwm1cmpaPre,epwm2cmpaPre,epwm3cmpaPre,epwm4cmpaPre,epwm5cmpaPre,epwm6cmpaPre;
int Min_Pulse = 450;  /*6us*f=6*75=450*/ 
/*PWM Varis end*/

int j;  
long lj=8191;
/* double ia,ib,ic;  */

int ErrFlag = 0;  /*  过压-0x0004、过流-0x0008、驱动板-0x0010，上下电容电压差越限-0x0020,故障标志,0x0040整流发生两级跳变 */
double VFGamaStore = 0;
/* short  ModeFlag = 0;  *//*  Flag for Modulation Mode :1 SVPWML,2SVPWMH,3-8 for SHE1-SHE11 */

double pt2t1,pt3t2,pt3t1;
double pt1,pt2,pt3;
int MP_Debug;
int Ct1t2t3,Bbit,Sbit,Gbit;
int MPhalf = (int)0.5*MP;

int Epwm_g_i_timeconti = MinP+1; 
int EPwm_g_i_PRDPre;
int EPwm_g_i_CAUPre; 
int EPwm_g_i_ZROPre; 
int EPwm_g_i_CADPre;
/*double MinP = 4800; */ /*该值需要比150us的表格最小脉宽稍小些 7200对应144us,比7500稍小一些7500=150us*50M*/

unsigned int ClearCmd;
unsigned int faultCode1,faultCode2,faultCode3,faultCode4;

int temp;
int temp11,temp22,temp33,temp44;
//unsigned int runState=0;
unsigned int      VMEConnectFlag=0;
unsigned int	  VMEConnectErrCnt=0;
unsigned int VMEConnectOKCnt=0;
/* int Reg_UpDown=0;    */

/*struct txStruct txCpuData;
struct rxStruct rxCpuData;*/
unsigned  int SVMSHECmd = 0;   

double VFGama6[6] = {0.01,0.01,0.01,0.01,0.01,0.01};
/* int gama_Num[6], gama_Num_pre[6];  */

const double * TbStartPointer;
double VFGama6_g_iC = 0;
double VFGama_Pre6_g_iC = 0;


double 	f1point = 30;   /*  SVM - SHEPWM11     20 */
double 	f2point = 35;   /*  SHEPWM11 -SHEPWM9  33             */
double 	f3point = 44;   /*  SHEPWM9 - SHEPWM7  40             */
double 	f4point = 57;   /*  SHEPWM7 - SHEPWM5  50              */
double 	f5point = 115;//80;   /*  SHEPWM5 - SHEPWM3  70   80     305    */
double 	f6point = 150;  /*  SHEPWM3 - SHEPWM1  100 405    130  350*/
double fpoint=95;//100;//44;

double 	f1pointB =28;   /* cdd, 28Hz? */
double 	f2pointB =33;        
double 	f3pointB =42;          
double 	f4pointB =55;                  
double 	f5pointB =113;//78;   //78  303           
double 	f6pointB =148;//400  128  348
double 	fswitch=95;
double  fpointWXX = 50; 
double   VFGama_Pre6[6] = {0.01,0.01,0.01,0.01,0.01,0.01};

double  deltGamaSHE = 0;

int g_i = 0;
int MP_test=1;

const double SHE_1[]=
{1.429424657,
1.429424657,
1.429424657,
1.429424657,
1.429424657,
1.429424657,
1.429424657,
1.429424657,
1.429424657,
1.429424657,
1.429424657,
1.429424657,
1.429424657,
1.429424657,
1.429424657,
1.429424657,
1.425178294,
1.41600599,
1.40682054,
1.397621107,
1.388406845,
1.379176897,
1.369930392,
1.360666445,
1.351384157,
1.342082614,
1.332760887,
1.323418027,
1.314053069,
1.304665029,
1.2952529,
1.285815656,
1.276352248,
1.266861602,
1.25734262,
1.247794174,
1.238215111,
1.228604247,
1.218960367,
1.209282221,
1.199568524,
1.189817956,
1.180029156,
1.17020072,
1.160331202,
1.15041911,
1.140462899,
1.130460976,
1.12041169,
1.110313332,
1.10016413,
1.089962249,
1.079705779,
1.069392737,
1.059021063,
1.048588609,
1.038093138,
1.027532315,
1.016903706,
1.006204761,
0.995432817,
0.984585082,
0.97365863,
0.962650387,
0.951557123,
0.940375441,
0.929101757,
0.917732295,
0.906263062,
0.894689834,
0.883008136,
0.871213219,
0.859300036,
0.847263211,
0.835097012,
0.822795315,
0.810351562,
0.797758718,
0.78500922,
0.772094918,
0.75900701,
0.745735961,
0.732271421,
0.718602118,
0.704715737,
0.690598782,
0.676236408,
0.661612224,
0.646708058,
0.631503668,
0.615976403,
0.600100772,
0.583847925,
0.567184995,
0.550074267,
0.532472117,
0.514327623,
0.49558074,
0.476159831,
0.455978271,
0.43492966,
0.412880865,
0.389661566,
0.365047871,
0.33873531,
0.310291299,
0.279064084,
0.24398649,
0.203071928,
0.151666588};

const double SHE_3[]=
{1.051610846,1.051610846,1.50953527,
1.049807536,1.049807536,1.50953527,
1.052401112,1.052401112,1.50953527,
1.054977657,1.054977657,1.50953527,
1.057536504,1.057536504,1.50953527,
1.060076933,1.060076933,1.50953527,
1.062598177,1.062598177,1.50953527,
1.065099409,1.065099409,1.507270631,
1.06757974,1.06757974,1.498180551,
1.070038223,1.070038223,1.489084456,
1.072473833,1.072473833,1.47998158,
1.074885475,1.074885475,1.470871152,
1.077271973,1.077271973,1.461752394,
1.079632061,1.079632061,1.452624524,
1.081964379,1.081964379,1.44348675,
1.084267464,1.084267464,1.434338276,
1.086539738,1.086539738,1.425178294,
1.088779502,1.088779502,1.41600599,
1.090984922,1.090984922,1.40682054,
0.970631904,1.093154018,1.503526199,
0.972762534,1.095284648,1.49456777,
0.974852376,1.09737449,1.485600173,
0.976898915,1.099421029,1.476622537,
0.97889942,1.101421534,1.46763397,
0.980602566,1.103373035,1.458841219,
0.977678847,1.105272295,1.453862733,
0.97474235,1.107115786,1.448838548,
0.971792651,1.108899647,1.443765099,
0.968829248,1.110619656,1.438638521,
0.965851559,1.112271177,1.433454617,
0.962858907,1.113849114,1.428208819,
0.959850507,1.115347852,1.422896134,
0.956825458,1.116761192,1.4175111,
0.953782716,1.118082269,1.412047718,
0.95072108,1.119303465,1.406499382,
0.947639165,1.120416304,1.4008588,
0.94453537,1.121411324,1.395117893,
0.941407845,1.122277935,1.389267688,
0.938254442,1.123004245,1.38329818,
0.935072664,1.123576855,1.377198186,
0.931859598,1.123980615,1.370955156,
0.928611829,1.124198329,1.364554958,
0.925325335,1.124210398,1.357981621,
0.921995363,1.123994398,1.351217024,
0.918616253,1.123524543,1.344240527,
0.915181231,1.122771052,1.337028524,
0.911682133,1.121699346,1.3295539,
0.90810904,1.120269057,1.32178538,
0.904449809,1.118432794,1.313686725,
0.90068943,1.116134584,1.305215767,
0.896809175,1.113307891,1.296323226,
0.892785417,1.109873109,1.286951292,
0.888587998,1.105734341,1.277031916,
0.884177937,1.100775285,1.266484825,
0.879504151,1.094853971,1.255215291,
0.874498733,1.087796093,1.24311184,
0.869070054,1.079386753,1.230044377,
0.863092642,1.06936073,1.215863797,
0.856392408,1.05739225,1.200405359,
0.848725622,1.04308747,1.183500418,
0.839751088,1.025987892,1.165005027,
0.82900021,1.005603376,1.144859181,
0.81586582,0.9815105,1.123191911,
0.799666351,0.95356529,1.100466728,
0.779879863,0.922238981,1.077587088,
0.756570229,0.888907017,1.055777556,
0.730715432,0.855701238,1.036139378,
0.702248938,0.824771052,1.020480492,
0.674987955,0.797510069,1.006918126,
0.651842039,0.774364153,0.99362113,
0.631228902,0.755124263,0.981575675,
0.611016614,0.739289965,0.971840097,
0.592692066,0.726302089,0.962874092,
0.576005299,0.715647881,0.954447202,
0.560708857,0.70689337,0.946396288,
0.546581716,0.699683636,0.938604389,
0.533435315,0.693731959,0.930985668,
0.521112093,0.688806838,0.923475178,
0.509481449,0.684720147,0.916021961,
0.498435236,0.681317307,0.908584337,
0.48788362,0.678469415,0.901126611,
0.477751533,0.676067,0.893616664,
0.467975751,0.674015045,0.886024114,
0.458502507,0.672228926,0.878318783,
0.449285537,0.670630986,0.870469308,
0.44028447,0.669147497,0.862441775,
0.431463466,0.66770578,0.854198209,
0.422790016,0.666231266,0.845694818,
0.414233834,0.664644238,0.836879785,
0.405765741,0.662855939,0.827690388,
0.397356432,0.660763601,0.818049086,
0.388974985,0.658243739,0.807858041,
0.380586839,0.655142656,0.796991215,
0.372150843,0.651262422,0.78528265,
0.363614573,0.646339307,0.77250848,
0.347684775,0.635836287,0.758358401,
0.324770891,0.61986635,0.742388464,
0.301052657,0.601417108,0.723939222,
0.276720016,0.579463387,0.701985501,
0.252324852,0.552319505,0.674841619,
0.229298273,0.517015567,0.639537681};

const double SHE_5[]=
{0.873294965,0.873294965,1.229099868,1.229099868,1.533097215,
0.873852644,0.873852644,1.223966951,1.223966951,1.533097215,
0.875028747,0.875028747,1.226188783,1.226188783,1.533097215,
0.876192644,0.876192644,1.228395826,1.228395826,1.533097215,
0.877344012,0.877344012,1.230587893,1.230587893,1.533097215,
0.878482521,0.878482521,1.232764767,1.232764767,1.525435789,
0.879607818,0.879607818,1.234926187,1.234926187,1.516355458,
0.88071953,0.88071953,1.237071856,1.237071856,1.507270631,
0.881817266,0.881817266,1.239201434,1.239201434,1.498180551,
0.882900611,0.882900611,1.241314534,1.241314534,1.489084456,
0.88396913,0.88396913,1.243410723,1.243410723,1.47998158,
0.885022362,0.885022362,1.245489515,1.245489515,1.470871152,
0.886059823,0.886059823,1.172152145,1.247550369,1.532482109,
0.887081,0.887081,1.174194459,1.249592683,1.52345903,
0.888085349,0.888085349,1.176217566,1.25161579,1.514431291,
0.889072303,0.889072303,1.178220728,1.253618952,1.505398138,
0.890041257,0.890041257,1.180203131,1.255601355,1.496358811,
0.89099157,0.89099157,1.182163873,1.257562097,1.487312544,
0.891922566,0.891922566,1.178956415,1.259500186,1.483038568,
0.817435303,0.892833527,1.176429333,1.257341674,1.531238609,
0.818325469,0.893723693,1.173884081,1.263303907,1.530238609,
0.819194029,0.894592253,1.171320104,1.265166997,1.525347583,
0.820040124,0.895438348,1.168736799,1.267002321,1.520444082,
0.820862835,0.896261059,1.166133506,1.268808249,1.515526862,
0.821661183,0.897059407,1.163509505,1.270582979,1.510594555,
0.822434123,0.897832347,1.160864011,1.272324513,1.50564565,
0.823180531,0.898578755,1.158196166,1.274030634,1.500678482,
0.823899205,0.899297429,1.155505032,1.275698876,1.495691199,
0.824588849,0.899987073,1.15278958,1.277326495,1.490681752,
0.825248064,0.900646288,1.150048685,1.278910425,1.485647844,
0.825875338,0.901273562,1.147281108,1.280447237,1.480586915,
0.826469029,0.901867253,1.144485483,1.281933084,1.475496088,
0.82702735,0.902425574,1.141660302,1.283363639,1.470372128,
0.827548348,0.902946572,1.138803891,1.284734018,1.465211378,
0.826313952,0.903428102,1.135914388,1.286038694,1.461280352,
0.824773477,0.9038678,1.132989711,1.287271387,1.457499363,
0.823219465,0.90426305,1.130027521,1.288424935,1.453644467,
0.821651061,0.904610934,1.127025177,1.289491136,1.44970797,
0.820067263,0.904908184,1.123979682,1.290460556,1.445681089,
0.818466897,0.905151116,1.120887609,1.291322288,1.441553748,
0.816848575,0.905335542,1.117745013,1.292063662,1.437314326,
0.815210648,0.905456664,1.114547318,1.292669868,1.432949334,
0.813551146,0.905508939,1.111289168,1.293123493,1.428443021,
0.811867693,0.905485896,1.107964236,1.293403927,1.423776865,
0.810157398,0.905379897,1.104564968,1.293486589,1.418928933,
0.808416713,0.905181818,1.101082236,1.293341933,1.413873036,
0.806641222,0.904880608,1.097504873,1.292934129,1.408577648,
0.804825364,0.904462681,1.093819014,1.292219303,1.403004451,
0.802962028,0.903911046,1.090007171,1.291143157,1.39710641,
0.801041959,0.903204053,1.086046888,1.289637694,1.390825142,
0.799052874,0.902313521,1.081908757,1.287616636,1.384087305,
0.7969781,0.901201876,1.077553381,1.284968913,1.376799559,
0.794794402,0.899817649,1.072926647,1.281549211,1.368841418,
0.792468397,0.89808811,1.067952051,1.277164005,1.360055027,
0.789950369,0.895906764,1.062517855,1.271550521,1.350230379,
0.786276111,0.893111124,1.056454703,1.26368586,1.339084084,
0.778313937,0.889441205,1.049495035,1.250831676,1.3262299,
0.770551678,0.884457835,1.041196958,1.235744536,1.31114276,
0.763088518,0.877374373,1.030800287,1.217737435,1.293135659,
0.755963465,0.866708078,1.016978864,1.196040567,1.271438791,
0.748734796,0.849673611,0.99763494,1.170292441,1.245690665,
0.739041327,0.82214005,0.971044336,1.14200507,1.217403294,
0.707851186,0.78324941,0.940788891,1.110555575,1.19592305,
0.666552192,0.741950416,0.91557967,1.084622148,1.180506432,
0.632096569,0.707494793,0.897958169,1.065820536,1.16560361,
0.606035816,0.68143404,0.885235014,1.050937002,1.150651242,
0.586537351,0.661935575,0.874943634,1.037667019,1.135492005,
0.571603829,0.647002053,0.865643784,1.024707596,1.120000837,
0.559717484,0.635115708,0.856475726,1.011283694,1.104077292,
0.549768571,0.625166795,0.846833673,0.996881814,1.087674756,
0.539107797,0.616298953,0.836202296,0.981145162,1.071883435,
0.526347801,0.607788055,0.82409111,0.963866607,1.057228168,
0.513740648,0.598968622,0.810050316,0.945056672,1.042331767,
0.500905837,0.589222765,0.793786927,0.925068833,1.027581052,
0.487544041,0.578063178,0.775380964,0.90471386,1.013494292,
0.473516404,0.565315071,0.755481879,0.88520539,1.000580573,
0.458925526,0.551281706,0.735233571,0.867805164,0.989153781,
0.444102439,0.536684913,0.71584022,0.853335153,0.97923683,
0.429470617,0.522355462,0.69810443,0.84195756,0.970625168,
0.41538842,0.508927116,0.68229701,0.833341241,0.963025461,
0.402072999,0.496731566,0.668314226,0.826958947,0.956159117,
0.389607981,0.4858542,0.655886395,0.822291098,0.949802492,
0.37798579,0.476233217,0.644713588,0.818906125,0.943788235,
0.367148793,0.467738219,0.634525836,0.816470066,0.937993185,
0.357017695,0.46021719,0.625099839,0.814730259,0.932325121,
0.347507994,0.453520058,0.616257016,0.81349455,0.926712004,
0.338538308,0.447508521,0.607855661,0.812613179,0.921093931,
0.330033912,0.442058747,0.599782445,0.811964543,0.915417046,
0.321927676,0.437060666,0.591945002,0.811444105,0.909628558,
0.314159678,0.432415762,0.584265841,0.810955268,0.903672095,
0.306676139,0.428034195,0.576677346,0.810400978,0.897482599,
0.299428,0.423831533,0.569117446,0.809674695,0.890979808,
0.292369174,0.419724949,0.561525413,0.808648964,0.884058908,
0.269734304,0.415628382,0.553837045,0.801177659,0.876575883,
0.245290728,0.411445481,0.545977987,0.792924648,0.868322872,
0.218546284,0.40705774,0.537852595,0.783585584,0.858983808,
0.205074066,0.402301466,0.522938624,0.772650084,0.848048308,
0.202984472,0.396915858,0.502473372,0.759230273,0.834628497,
0.182354097,0.390403231,0.488420922,0.741621838,0.817020062,
0.162286887,0.381547231,0.4720251,0.716064022,0.791462246,
0.125127619,0.365896766,0.456374635,0.672290251,0.747688475};

const double SHE_7[]=
{0.782016651,0.782016651,1.04849657,1.04849657,1.312092652,1.312092652,1.543464471,
0.786071768,0.786071768,1.048500198,1.048500198,1.310842473,1.310842473,1.543464471,
0.786737315,0.786737315,1.049790032,1.049790032,1.312676681,1.312676681,1.543464471,
0.787394661,0.787394661,1.05106688,1.05106688,1.314499559,1.314499559,1.543464471,
0.788043639,0.788043639,1.052330536,1.052330536,1.316311067,1.316311067,1.534512379,
0.788684086,0.788684086,1.05358078,1.05358078,1.318111147,1.318111147,1.525435789,
0.789315827,0.789315827,1.054817373,1.054817373,1.319899709,1.319899709,1.516355458,
0.789938677,0.789938677,1.05604005,1.05604005,1.321676635,1.321676635,1.507270631,
0.790552444,0.790552444,1.057248526,1.057248526,1.323441776,1.323441776,1.498180551,
0.791156923,0.791156923,1.058442489,1.058442489,1.271473715,1.32519495,1.54090421,
0.791751903,0.791751903,1.059621604,1.059621604,1.273214707,1.326935942,1.531854911,
0.792337157,0.792337157,1.060785506,1.060785506,1.274943264,1.328664499,1.522802085,
0.792912452,0.792912452,1.061933803,1.061933803,1.276659096,1.330380331,1.513744985,
0.793477538,0.793477538,1.063066072,1.063066072,1.278361868,1.332083103,1.50468286,
0.794032155,0.794032155,1.010460621,1.064181856,1.280051201,1.333772436,1.541932595,
0.79457603,0.79457603,1.01155943,1.065280665,1.279883142,1.335447903,1.534679694,
0.795108875,0.795108875,1.012640735,1.06636197,1.277836722,1.337109021,1.529211498,
0.795630385,0.795630385,1.013703967,1.067425202,1.275775105,1.33875525,1.523740992,
0.742419004,0.796140239,1.014748512,1.068469747,1.27369778,1.327419015,1.543048653,
0.742916866,0.796638101,1.015773711,1.069494946,1.271604193,1.325325428,1.533991757,
0.743402378,0.797123613,1.016778852,1.070500087,1.269493743,1.323214978,1.524930289,
0.743875161,0.797596396,1.017014704,1.071484405,1.267365778,1.34517806,1.539936224,
0.744334816,0.798056051,1.015440162,1.07244707,1.265219592,1.346739226,1.536636434,
0.744780917,0.798502152,1.013851993,1.07338719,1.263054418,1.348280638,1.533324608,
0.745213014,0.798934249,1.0122499,1.074303798,1.260869424,1.349801126,1.529999602,
0.745630624,0.799351859,1.010633551,1.075195848,1.258663707,1.351299383,1.526660156,
0.746033235,0.79975447,1.009002576,1.076062205,1.256436284,1.352773948,1.523304878,
0.746420298,0.800141533,1.007356564,1.076901636,1.254186085,1.354223179,1.519932221,
0.746791224,0.800512459,1.005695061,1.077712802,1.25191194,1.355645238,1.516540472,
0.747145381,0.800866616,1.004017559,1.078494239,1.249612573,1.357038054,1.513127711,
0.747482085,0.80120332,1.002323495,1.079244349,1.247286584,1.358399291,1.509691793,
0.747800598,0.801521833,1.000612241,1.079961383,1.244932436,1.359726309,1.506230305,
0.748100119,0.801821354,0.998883098,1.080643416,1.242548436,1.361016112,1.502740524,
0.748379773,0.802101008,0.997135283,1.081288327,1.240132713,1.362265291,1.499219364,
0.748638603,0.802359838,0.995367915,1.081893774,1.237683193,1.363469952,1.495663322,
0.748875558,0.802596793,0.993580007,1.082457153,1.235197565,1.36462563,1.492068386,
0.749089471,0.802810706,0.991770438,1.082975564,1.232673248,1.36572718,1.488429956,
0.749279048,0.803000283,0.989937937,1.083445756,1.23010734,1.366768652,1.484742723,
0.749442839,0.803164074,0.98808105,1.083864072,1.227496565,1.367743123,1.481000531,
0.749579209,0.803300444,0.986198106,1.084226367,1.224837198,1.368642493,1.477196192,
0.749686298,0.803407533,0.984287169,1.084527919,1.222124976,1.369457231,1.473321275,
0.749761976,0.803483211,0.982345981,1.084763302,1.219354985,1.370176042,1.469365812,
0.749803773,0.803525008,0.98037188,1.08492623,1.216521508,1.37078544,1.46531793,
0.749535792,0.803530034,0.978361698,1.085009354,1.213617829,1.371269197,1.461350535,
0.748499211,0.80349486,0.976311623,1.085003981,1.210635972,1.371607603,1.457758436,
0.747443843,0.803415362,0.974217004,1.084899707,1.207566338,1.371776485,1.454003656,
0.746367189,0.803286503,0.97207208,1.08468389,1.204397213,1.371745861,1.450058413,
0.745266074,0.803102016,0.969869599,1.084340919,1.201114057,1.371478085,1.445888032,
0.744136387,0.802853938,0.967600245,1.083851134,1.197698473,1.370925224,1.441448636,
0.742972695,0.802531914,0.965251783,1.083189223,1.194126661,1.370025284,1.436683845,
0.74176762,0.802122101,0.962807714,1.082321726,1.190367029,1.368696633,1.431519945,
0.740510843,0.801605393,0.960245099,1.081203029,1.186376356,1.366829566,1.425858645,
0.739187395,0.800954398,0.95753087,1.079768654,1.182093394,1.364273129,1.419565929,
0.734744761,0.800128047,0.954615235,1.077923411,1.177427626,1.358733104,1.412454339,
0.728045177,0.799061281,0.951419161,1.07551926,1.172238451,1.350532742,1.404253977,
0.721416485,0.797643815,0.947808703,1.072310878,1.166293925,1.340842284,1.394563519,
0.714939245,0.795671868,0.943537311,1.06785876,1.159182677,1.32904478,1.382766015,
0.708750092,0.792724233,0.938100401,1.061296402,1.150109822,1.314167085,1.36788832,
0.703039269,0.787792139,0.930317441,1.05071652,1.137397238,1.294700824,1.348422059,
0.697621822,0.777998017,0.917028295,1.031603167,1.117450686,1.268826256,1.322547491,
0.679742777,0.754952505,0.897824262,0.996555983,1.086247077,1.237702988,1.291424223,
0.658378354,0.712099589,0.858609631,0.956178465,1.055106473,1.21095174,1.264672975,
0.616825853,0.670547088,0.840272381,0.931604082,1.035905082,1.191820898,1.245542133,
0.587823465,0.6415447,0.826285117,0.916697862,1.022409496,1.175506815,1.22922805,
0.567923787,0.621645022,0.814277493,0.904409298,1.009994659,1.159365966,1.213087201,
0.553181033,0.606902268,0.802882503,0.89130042,0.996490861,1.142330056,1.196051291,
0.540799305,0.59452054,0.790969563,0.87495617,0.980511153,1.12411244,1.177833675,
0.528462846,0.582184081,0.77689153,0.85334403,0.96148496,1.105250581,1.158971816,
0.514077529,0.567798764,0.750457712,0.826395901,0.940939491,1.084829869,1.144808974,
0.496818565,0.5505398,0.725298898,0.798524605,0.922559835,1.066402814,1.128674963,
0.478285824,0.532007059,0.701161928,0.775568373,0.908508573,1.051752608,1.115316975,
0.460852107,0.514573342,0.681118908,0.759181051,0.897971179,1.039725876,1.103451196,
0.445690956,0.499412191,0.665108689,0.747866363,0.889385009,1.028928991,1.092060205,
0.432858831,0.486580066,0.652013501,0.739761519,0.881601634,1.018392398,1.080611863,
0.421954452,0.475675687,0.640785716,0.733479999,0.873863841,1.007492883,1.068846705,
0.412035709,0.46619884,0.6306356,0.728043069,0.865604037,0.995809158,1.056847796,
0.401146914,0.457661688,0.620958152,0.722685092,0.856309921,0.983055172,1.045253786,
0.3907652,0.449596103,0.611236158,0.716704294,0.845465822,0.969092655,1.033263743,
0.380576592,0.441529435,0.600970014,0.709382729,0.832584207,0.95402218,1.021078062,
0.370266924,0.432970452,0.589662726,0.700025391,0.817382671,0.938339549,1.009083567,
0.359547529,0.423459106,0.576921672,0.688225269,0.80013115,0.923050843,0.997811128,
0.34824661,0.412739509,0.562725151,0.674345042,0.781938724,0.909486426,0.987766578,
0.336434952,0.400990602,0.547668586,0.659719207,0.764447651,0.898690589,0.979197464,
0.324439923,0.388833751,0.532769566,0.645997337,0.748931819,0.890893733,0.97200321,
0.312678222,0.377005564,0.518894673,0.634216901,0.735760895,0.88563442,0.96587185,
0.301469911,0.366028175,0.506429154,0.624590392,0.724648572,0.882233356,0.960468306,
0.290976553,0.356129697,0.495364336,0.616852745,0.71510336,0.880099553,0.955526092,
0.281233609,0.347327523,0.485507827,0.610601731,0.706673216,0.878802622,0.950855355,
0.272203358,0.33953024,0.476625132,0.605459266,0.699008377,0.878044843,0.946322133,
0.263814672,0.332605043,0.468500655,0.601115482,0.691851411,0.877617078,0.941826409,
0.255985968,0.32641225,0.460954229,0.597325842,0.685011741,0.87736307,0.937285125,
0.248636401,0.320819689,0.453839587,0.59389545,0.678342575,0.877153445,0.932619005,
0.241690237,0.315706634,0.441955083,0.590662412,0.671723125,0.874019176,0.927740411,
0.235077496,0.310962537,0.426689655,0.587482761,0.665044658,0.868817588,0.922538823,
0.228732401,0.306482789,0.411002307,0.58421597,0.658197898,0.86313756,0.916858795,
0.222589895,0.302161554,0.394794086,0.580707954,0.651058343,0.856738879,0.910460114,
0.216579085,0.297879129,0.377957429,0.576764607,0.643462873,0.849214375,0.90293561,
0.210609021,0.293474869,0.360377136,0.572096447,0.635159621,0.839796113,0.893517348,
0.194529409,0.288671725,0.347808402,0.566162592,0.62566429,0.826814205,0.88053544,
0.173703628,0.282773338,0.336494573,0.557529397,0.613663127,0.805754098,0.859475333,
0.145234861,0.272207142,0.325928377,0.538346516,0.592067751,0.758408186,0.812129421};
  
const double SHE_9[]=
{0.729157054,0.729157054,0.941860124,0.941860124,1.153415418,1.153415418,1.363406041,1.363406041,1.550061815,
0.733470925,0.733470925,0.943324753,0.943324753,1.153142708,1.153142708,1.362908842,1.362908842,1.550061815,
0.73389789,0.73389789,0.944161809,0.944161809,1.154356749,1.154356749,1.364452074,1.364452074,1.550061815,
0.734319095,0.734319095,0.944988837,0.944988837,1.155559332,1.155559332,1.365986548,1.365986548,1.543585979,
0.734734456,0.734734456,0.945805702,0.945805702,1.156750346,1.156750346,1.36751228,1.36751228,1.534512379,
0.735143876,0.735143876,0.946612251,0.946612251,1.157929654,1.157929654,1.369029264,1.369029264,1.525435789,
0.735547257,0.735547257,0.947408323,0.947408323,1.159097104,1.159097104,1.370537473,1.370537473,1.516355458,
0.735944496,0.735944496,0.948193744,0.948193744,1.16025252,1.16025252,1.330567835,1.372036858,1.547782506,
0.736335484,0.736335484,0.948968325,0.948968325,1.161395707,1.161395707,1.332058324,1.373527347,1.538723454,
0.736720107,0.736720107,0.949731865,0.949731865,1.162526445,1.162526445,1.333539821,1.375008844,1.529661598,
0.737098243,0.737098243,0.950484149,0.950484149,1.16364449,1.16364449,1.335012204,1.376481227,1.520596191,
0.737469767,0.737469767,0.951224944,0.951224944,1.123280552,1.164749575,1.336475323,1.377944346,1.54930619,
0.737834545,0.737834545,0.951954005,0.951954005,1.12437238,1.165841403,1.337929003,1.379398026,1.540265557,
0.738192439,0.738192439,0.952671066,0.952671066,1.125450627,1.16691965,1.339373033,1.380842056,1.53122198,
0.7385433,0.7385433,0.953375846,0.953375846,1.126514938,1.167983961,1.338636937,1.382276195,1.524289656,
0.738886975,0.738886975,0.912599021,0.954068044,1.127564927,1.16903395,1.336934701,1.378403724,1.546429139,
0.739223301,0.739223301,0.913278317,0.95474734,1.128600169,1.170069192,1.335220177,1.38511365,1.545652133,
0.739552107,0.739552107,0.913944366,0.955413389,1.129354976,1.171089227,1.333492917,1.386516289,1.539912306,
0.698404189,0.739873212,0.914596803,0.956065826,1.127921362,1.172093554,1.331752436,1.373221459,1.549037084,
0.698717403,0.740186426,0.915235236,0.956704259,1.126474792,1.173081626,1.329998211,1.377768692,1.548375487,
0.699022524,0.740491547,0.915859248,0.957328271,1.125014972,1.174052849,1.328229673,1.382976624,1.548375487,
0.69931934,0.740788363,0.916468392,0.957937415,1.123541579,1.175006576,1.326446206,1.388170625,1.548375487,
0.699607626,0.741076649,0.917062188,0.958531211,1.12205426,1.175942102,1.324647139,1.393350645,1.548375487,
0.699887142,0.741356165,0.917640124,0.959109147,1.120552628,1.176858659,1.322831748,1.394677654,1.544593511,
0.700157635,0.741626658,0.918201651,0.959670674,1.119036258,1.177755409,1.320999242,1.395989661,1.540806075,
0.700418833,0.741887856,0.918239404,0.960215199,1.117504689,1.178631439,1.319148763,1.397285747,1.537415455,
0.700670449,0.742139472,0.917144121,0.960742087,1.115957414,1.179485749,1.317279375,1.398564878,1.534904651,
0.700912175,0.742381198,0.916038035,0.961250652,1.114393879,1.180317244,1.315390056,1.399825891,1.532379836,
0.701143678,0.742612701,0.91492088,0.961740153,1.112813476,1.181124725,1.313479687,1.401067473,1.529839659,
0.701364605,0.742833628,0.91379236,0.962209791,1.111215542,1.181906875,1.311547044,1.402288142,1.527282609,
0.701574572,0.743043595,0.912652144,0.962658695,1.109599345,1.182662242,1.309590781,1.403486217,1.524706993,
0.701773164,0.743242187,0.91149986,0.96308592,1.107964081,1.183389225,1.307609416,1.404659789,1.52211091,
0.701959933,0.743428956,0.910335092,0.963490435,1.106308864,1.184086054,1.305601311,1.405806682,1.519492214,
0.702134388,0.743603411,0.909157373,0.96387111,1.104632712,1.184750762,1.303564653,1.40692441,1.516848466,
0.702295993,0.743765016,0.907966178,0.964226707,1.102934538,1.185381162,1.301497424,1.408010115,1.514176891,
0.702444158,0.743913181,0.906760915,0.964555857,1.10121313,1.18597481,1.299397374,1.409060507,1.511474308,
0.702578233,0.744047256,0.905540911,0.964857045,1.09946713,1.186528964,1.29726198,1.410071773,1.508737058,
0.702697493,0.744166516,0.904305402,0.965128586,1.097695015,1.187040537,1.295088402,1.411039474,1.505960904,
0.702801128,0.744270151,0.903053514,0.965368589,1.095895064,1.187506033,1.292873426,1.411958416,1.503140907,
0.702888225,0.744357248,0.90178424,0.965574928,1.094065317,1.187921473,1.290613392,1.412822481,1.500271287,
0.702957749,0.744426772,0.900496418,0.965745188,1.092203533,1.1882823,1.288304111,1.413624415,1.497345209,
0.703008512,0.744477535,0.899188687,0.965876605,1.090307124,1.188583259,1.285940745,1.414355551,1.494354546,
0.703039142,0.744508165,0.897859446,0.965965991,1.088373075,1.188818239,1.28351767,1.415005456,1.491289551,
0.703048032,0.744517055,0.896506793,0.966009626,1.086397841,1.188980075,1.281028281,1.415561446,1.488138416,
0.703033279,0.744502302,0.895128436,0.966003117,1.084377197,1.189060273,1.278464737,1.416007956,1.484886709,
0.702992597,0.74446162,0.893721583,0.965941208,1.082306045,1.189048645,1.275817623,1.416325661,1.481516573,
0.70292319,0.744392213,0.892282775,0.965817507,1.080178133,1.188932797,1.27307546,1.41649027,1.478005645,
0.70282158,0.744290603,0.890807648,0.965624095,1.077985654,1.188697404,1.270224026,1.416470815,1.474325531,
0.702683334,0.744152357,0.889290585,0.965350947,1.075718648,1.188323141,1.267245347,1.416227172,1.470439588,
0.702502666,0.743971689,0.887724172,0.964985046,1.073364083,1.187785071,1.26411617,1.415706389,1.466299687,
0.702271777,0.7437408,0.886098327,0.96450897,1.0709044,1.1870501,1.26080556,1.414837095,1.461841296,
0.701979772,0.743448795,0.884398854,0.963898532,1.068315079,1.186072795,1.257270952,1.413520675,1.456975781,
0.699286239,0.743079764,0.882604883,0.963118656,1.065560372,1.18478815,1.253451317,1.41161686,1.453086883,
0.693530874,0.742609172,0.88068406,0.96211564,1.062585339,1.18309825,1.249254632,1.408919088,1.450389111,
0.687787448,0.741996507,0.878582763,0.960801507,1.059299773,1.180845833,1.244533132,1.405110209,1.446579232,
0.682096738,0.74116869,0.876204077,0.959019052,1.055542475,1.17775681,1.239029986,1.399677921,1.441146944,
0.676545029,0.739977275,0.873351228,0.956453019,1.050991268,1.17330007,1.232251107,1.391742431,1.433211454,
0.671300841,0.738065615,0.869553619,0.952361779,1.044895729,1.166292687,1.223113836,1.379685057,1.42115408,
0.666639639,0.734331377,0.863378652,0.944554535,1.035097881,1.153600595,1.208859345,1.360394274,1.401863297,
0.661558141,0.723893955,0.848881635,0.924687733,1.014130523,1.126382522,1.182557498,1.329359405,1.370828428,
0.6408435,0.689070815,0.812449372,0.879976955,0.976278442,1.084784595,1.147299507,1.295074732,1.336543755,
0.602216327,0.644040357,0.783879399,0.849830638,0.953713289,1.061620324,1.126940133,1.273683835,1.315152858,
0.571865344,0.61469868,0.770566273,0.83548968,0.941066988,1.047083951,1.112423385,1.25606201,1.297531033,
0.550992682,0.595829082,0.760887176,0.823702536,0.928854625,1.031650443,1.096839746,1.236862294,1.278331317,
0.536159307,0.581223027,0.749127253,0.80790113,0.912421235,1.010762008,1.077194739,1.214517394,1.255986417,
0.522922979,0.565775163,0.729610769,0.78201804,0.888986548,0.983526815,1.054036889,1.190924123,1.232393146,
0.504560414,0.546029437,0.701204962,0.748848986,0.865249312,0.958679392,1.034009502,1.164373929,1.206526896,
0.483381445,0.524850468,0.674663982,0.722601739,0.849473098,0.942280197,1.019891155,1.14916058,1.191652713,
0.464939783,0.506408806,0.655203769,0.706123802,0.839101791,0.930516274,1.008539396,1.13599727,1.178064129,
0.449775092,0.491409164,0.640738581,0.695349569,0.830437647,0.919601896,0.997414955,1.128258337,1.16972736,
0.436875071,0.478933708,0.62872638,0.686960717,0.821220005,0.907216847,0.985048217,1.113260046,1.154729069,
0.426282834,0.467751857,0.61724367,0.678570319,0.809565579,0.891583249,0.970558735,1.096851792,1.138566194,
0.415074829,0.456543852,0.604573079,0.667962761,0.79361529,0.871739306,0.954093076,1.079753545,1.122729665,
0.402598123,0.444067146,0.589329286,0.653450493,0.773058896,0.849511889,0.937730999,1.063730352,1.108228898,
0.3885338,0.430002823,0.571880602,0.636101909,0.751525949,0.829995229,0.924296348,1.050365864,1.095922277,
0.374048347,0.41551737,0.55468991,0.619668233,0.73344896,0.816363362,0.914370265,1.039554154,1.08540473,
0.360565801,0.402034824,0.539673668,0.606445076,0.719652613,0.807661602,0.906690958,1.030157813,1.07571849,
0.348710206,0.390179229,0.527077795,0.596349015,0.708901942,0.801876972,0.899983595,1.021161601,1.066164444,
0.338451331,0.379920354,0.516374335,0.588489797,0.699925345,0.797517836,0.893384925,1.011895846,1.05636257,
0.329487214,0.370956237,0.506937764,0.581999058,0.691814547,0.793584451,0.886262227,1.001917797,1.046118875,
0.321177589,0.362909603,0.49822109,0.57615737,0.683896256,0.789289773,0.878034444,0.990931406,1.035459859,
0.312127725,0.355380808,0.489736151,0.570314241,0.675566757,0.783851516,0.868080738,0.978804151,1.024805953,
0.303269228,0.347933949,0.480986191,0.563776217,0.666168052,0.776389587,0.855777327,0.965695521,1.013914773,
0.29426741,0.340067003,0.471412796,0.555740975,0.654963955,0.76606005,0.840798231,0.952284842,1.003256562,
0.284775598,0.331249353,0.460467639,0.545464183,0.641428896,0.752722366,0.823778874,0.939895648,0.993503746,
0.274585019,0.321176454,0.44799604,0.532933503,0.626028811,0.737917621,0.806729765,0.930025584,0.985249097,
0.263859087,0.310160646,0.434708202,0.519504555,0.610557293,0.724368251,0.791894207,0.92332569,0.978627558,
0.253099184,0.299048537,0.421835119,0.507059823,0.596786249,0.713750879,0.780051884,0.919309143,0.973300258,
0.242797108,0.288621222,0.410219286,0.496607729,0.585256408,0.706008299,0.770667421,0.917083265,0.968799211,
0.233219687,0.279260616,0.400055487,0.488177525,0.575641664,0.700376349,0.762919883,0.915927357,0.964761295,
0.22443299,0.27102551,0.391177907,0.4813878,0.567419067,0.696125679,0.756170525,0.915379236,0.960950333,
0.216392992,0.263815672,0.383323079,0.475812142,0.560145333,0.692727406,0.749992586,0.915151138,0.957210889,
0.209011175,0.257477385,0.376242934,0.471094214,0.548821622,0.689815218,0.744100421,0.911957064,0.953426087,
0.202188034,0.251851358,0.369732853,0.466956582,0.536663685,0.687122958,0.738287094,0.908018203,0.949487226,
0.195826688,0.246788895,0.363628305,0.463180619,0.524409415,0.684435236,0.732381327,0.903797812,0.945266835,
0.189835987,0.242152918,0.357792444,0.459581938,0.511929968,0.68154876,0.726215023,0.899113687,0.94058271,
0.184127403,0.237810467,0.352100349,0.455984095,0.498946667,0.678120621,0.719589644,0.89366049,0.935129513,
0.178605058,0.233614937,0.328766445,0.452181181,0.493650204,0.67075268,0.712221703,0.886844088,0.928313111,
0.173137885,0.229359092,0.301647785,0.447851518,0.489320541,0.66213534,0.703604363,0.87727802,0.918747043,
0.167445492,0.224582504,0.272789076,0.442204409,0.483673432,0.650952062,0.692421085,0.860670186,0.902139209,
0.138212247,0.216473662,0.257942685,0.429907822,0.471376845,0.628256314,0.669725337,0.812822561,0.854291584};

const double SHE_11[]=
{0.694537635,0.694537635,0.871475141,0.871475141,1.047822466,1.047822466,1.223403998,1.223403998,1.397977707,1.397977707,1.553831726,
0.698432702,0.698432702,0.873257777,0.873257777,1.048065408,1.048065408,1.222847521,1.222847521,1.39759689,1.39759689,1.553831726,
0.698729526,0.698729526,0.873843304,0.873843304,1.048923596,1.048923596,1.223954878,1.223954878,1.398923394,1.398923394,1.552657338,
0.699022122,0.699022122,0.874421118,0.874421118,1.049772027,1.049772027,1.225052498,1.225052498,1.400242964,1.400242964,1.543585979,
0.699310436,0.699310436,0.874991128,0.874991128,1.050610598,1.050610598,1.226140316,1.226140316,1.40155563,1.40155563,1.534512379,
0.69959441,0.69959441,0.875553232,0.875553232,1.051439196,1.051439196,1.227218246,1.227218246,1.402861408,1.402861408,1.525435789,
0.699873982,0.699873982,0.876107323,0.876107323,1.052257693,1.052257693,1.228286189,1.228286189,1.370231096,1.404160297,1.549738132,
0.700149089,0.700149089,0.876653284,0.876653284,1.053065947,1.053065947,1.229344024,1.229344024,1.371523077,1.405452278,1.540674112,
0.700419663,0.700419663,0.87719099,0.87719099,1.053863802,1.053863802,1.230391611,1.230391611,1.372808113,1.406737314,1.531607517,
0.700685632,0.700685632,0.877720307,0.877720307,1.054651088,1.054651088,1.231428792,1.231428792,1.374086149,1.40801535,1.522537599,
0.70094692,0.70094692,0.878241094,0.878241094,1.055427617,1.055427617,1.198526183,1.232455384,1.375357108,1.409286309,1.545300718,
0.701203451,0.701203451,0.8787532,0.8787532,1.056193188,1.056193188,1.199541986,1.233471187,1.376620897,1.410550098,1.536247168,
0.701455141,0.701455141,0.879256462,0.879256462,1.05694758,1.05694758,1.200546771,1.234475972,1.377877396,1.411806597,1.527190525,
0.701701899,0.701701899,0.879750707,0.879750707,1.023761353,1.057690554,1.201540286,1.235469487,1.378240777,1.413055664,1.548293621,
0.701943636,0.701943636,0.880235754,0.880235754,1.02449265,1.058421851,1.202522251,1.236451452,1.376795073,1.414297133,1.541891477,
0.702180254,0.702180254,0.880711406,0.880711406,1.025211992,1.059141193,1.20349236,1.237421561,1.375339554,1.415530809,1.535489525,
0.702411649,0.702411649,0.847248256,0.881177457,1.025919077,1.059848278,1.202517439,1.238379474,1.373873855,1.413786228,1.553773186,
0.702637715,0.702637715,0.847704484,0.881633685,1.026613582,1.060542783,1.201227331,1.239324817,1.372397579,1.417973851,1.552407927,
0.668929136,0.702858337,0.848150655,0.882079856,1.027295154,1.061224355,1.19992553,1.233854731,1.370910296,1.409286748,1.553773186,
0.669144193,0.703073394,0.848586519,0.88251572,1.027963418,1.061892619,1.198611731,1.241176122,1.36941154,1.40871023,1.553773186,
0.669353559,0.70328276,0.849011809,0.88294101,1.027842071,1.062547168,1.1972856,1.242081143,1.367900805,1.412971844,1.553173186,
0.669557099,0.7034863,0.849426241,0.883355442,1.026770539,1.063187561,1.195946776,1.242971708,1.366377542,1.41701774,1.553173186,
0.669754669,0.70368387,0.849829511,0.883758712,1.025688166,1.063813327,1.194594862,1.243847227,1.364841154,1.421055456,1.553173186,
0.669946118,0.703875319,0.850221296,0.884150497,1.024594723,1.064423953,1.193229426,1.244707053,1.363290994,1.425084997,1.553173186,
0.670131285,0.704060486,0.85060125,0.884530451,1.023489954,1.065018887,1.191849999,1.245550477,1.361726355,1.426233732,1.550329426,
0.670309997,0.704239198,0.850968999,0.8848982,1.022373579,1.065597533,1.190456068,1.24637672,1.360146466,1.427370464,1.547479666,
0.670482071,0.704411272,0.851324147,0.885253348,1.02124529,1.066159241,1.189047074,1.247184927,1.358550486,1.428494423,1.54462323,
0.670647312,0.704576513,0.851666266,0.885595467,1.020104748,1.066703312,1.187622408,1.247974154,1.356937495,1.429604738,1.541759356,
0.670805507,0.704734708,0.851994892,0.885924093,1.01895158,1.067228981,1.186181404,1.248743364,1.355306483,1.430700425,1.538887188,
0.670956432,0.704885633,0.852277515,0.886238731,1.017785377,1.067735419,1.184723332,1.24949141,1.353656339,1.43178037,1.536029877,
0.671099841,0.705029042,0.851458953,0.886538841,1.016605687,1.068221721,1.183247393,1.250217022,1.351985842,1.432843303,1.533980604,
0.67123547,0.705164671,0.850631344,0.886823838,1.015412011,1.068686897,1.18175271,1.250918792,1.350293639,1.433887782,1.531914912,
0.671363032,0.705292233,0.849794406,0.887093087,1.014203799,1.069129862,1.180238316,1.251595154,1.348578233,1.434912155,1.52983109,
0.671482215,0.705411416,0.848947822,0.887345893,1.012980439,1.069549423,1.178703143,1.252244361,1.346837961,1.43591453,1.5277272,
0.671592677,0.705521878,0.848091234,0.887581493,1.011741252,1.069944266,1.17714601,1.252864458,1.345070964,1.436892726,1.525601028,
0.671694041,0.705623242,0.84722424,0.887799052,1.010485479,1.070312934,1.175565603,1.25345325,1.343275163,1.437844221,1.52345004,
0.671785891,0.705715092,0.846346382,0.887997641,1.009212271,1.07065381,1.173960455,1.254008262,1.341448217,1.438766084,1.521271309,
0.671867766,0.705796967,0.845457142,0.888176232,1.007920674,1.070965087,1.172328924,1.254526691,1.339587485,1.439654892,1.519061437,
0.67193915,0.705868351,0.844555926,0.888333675,1.006609605,1.071244739,1.170669158,1.255005347,1.337689965,1.44050662,1.516816462,
0.671999461,0.705928662,0.843642052,0.888468675,1.005277836,1.07149048,1.168979058,1.255440585,1.335752227,1.441316508,1.514531724,
0.67204804,0.705977241,0.842714734,0.888579769,1.003923956,1.071699712,1.167256232,1.255828204,1.333770332,1.442078887,1.512201699,
0.672084133,0.706013334,0.841773051,0.888665281,1.002546339,1.071869466,1.16549793,1.256163343,1.331739721,1.442786948,1.50981979,
0.67210687,0.706036071,0.840815928,0.888723284,1.001143089,1.071996312,1.163700965,1.256440322,1.329655073,1.443432446,1.507378042,
0.672115232,0.706044433,0.839842083,0.888751531,0.999711976,1.072076259,1.161861611,1.256652454,1.327510127,1.444005299,1.504866772,
0.672108019,0.70603722,0.838849981,0.888747374,0.998250344,1.072104606,1.159975453,1.256791785,1.32529744,1.444493043,1.502274061,
0.672083788,0.706012989,0.837837756,0.88870765,0.996754989,1.07207574,1.158037203,1.256848744,1.323008053,1.444880086,1.499585055,
0.672040783,0.705969984,0.836803103,0.888628514,0.99522198,1.071982868,1.15604042,1.256811658,1.320631039,1.445146653,1.496780994,
0.67197682,0.705906021,0.835743121,0.888505208,0.993646411,1.071817609,1.153977121,1.256666065,1.318152853,1.445267273,1.493837802,
0.671889126,0.705818327,0.834654087,0.888331712,0.992022017,1.071569405,1.151837201,1.256393699,1.315556374,1.445208563,1.490724049,
0.671774081,0.705703282,0.833531092,0.8881002,0.990340591,1.071224615,1.149607528,1.255970961,1.312819458,1.444925861,1.487397865,
0.671626807,0.705556008,0.832367459,0.887800173,0.988591042,1.07076505,1.147270509,1.255366492,1.309912648,1.444357996,1.483802145,
0.671440475,0.705369676,0.831153766,0.887416985,0.986757792,1.070165523,1.144801665,1.254537147,1.30679536,1.443418817,1.479856856,
0.670458872,0.705134246,0.829876066,0.886929203,0.984817911,1.069389463,1.142165294,1.253420926,1.303409197,1.441982891,1.475912092,
0.665453839,0.704834046,0.828512459,0.886303507,0.982735582,1.068380504,1.139306177,1.251923624,1.29966535,1.439860087,1.473789288,
0.660449649,0.704442622,0.827025822,0.885483904,0.9804504,1.067044838,1.136132185,1.249891401,1.295418772,1.436747502,1.470676703,
0.65548354,0.703910431,0.825346421,0.884366061,0.977849605,1.065209623,1.13247346,1.247047844,1.290409273,1.432131439,1.46606064,
0.650634417,0.703130162,0.823323038,0.88272549,0.974690718,1.062508546,1.127970853,1.242827533,1.284107338,1.425068515,1.458997716,
0.646081033,0.701812523,0.820548817,0.879963852,0.970330773,1.057989499,1.121698773,1.235844041,1.275231438,1.413646676,1.447575877,
0.642160144,0.69883155,0.815457004,0.873818247,0.962384,1.048262982,1.110449928,1.221752951,1.259906961,1.39365103,1.427580231,
0.635736118,0.68617338,0.797776761,0.850575157,0.937938122,1.017653266,1.081119146,1.187369965,1.22778583,1.359506155,1.393435356,
0.601431712,0.641677497,0.757369698,0.804501959,0.900867267,0.978136081,1.048245033,1.154287703,1.198518448,1.331265775,1.365194976,
0.565624618,0.605581363,0.739516662,0.785951096,0.886264259,0.962546626,1.033644374,1.138053776,1.182316023,1.31228108,1.346210281,
0.542968475,0.584649828,0.729671909,0.774580066,0.874714402,0.948546575,1.019266154,1.120564012,1.164809508,1.291535583,1.325464784,
0.527291822,0.568709336,0.716282284,0.757187573,0.856166977,0.925408029,0.997306137,1.095117984,1.141341395,1.2668831,1.300812301,
0.509219685,0.549004275,0.689142336,0.723737699,0.827624528,0.89354065,0.971060191,1.067981105,1.117767895,1.243947128,1.277876329,
0.491830335,0.525759536,0.659111706,0.696558608,0.808000099,0.873279925,0.954581358,1.050770037,1.101870068,1.226825753,1.260754954,
0.465281655,0.506029751,0.638864587,0.674391924,0.797152829,0.861304343,0.943225069,1.037575259,1.088701932,1.211294723,1.245223924,
0.449012504,0.490546013,0.624604938,0.663092552,0.787861598,0.849757689,0.931304725,1.022933451,1.074285015,1.194572604,1.228501805,
0.436362421,0.477205678,0.611746774,0.652770749,0.775421971,0.833506623,0.915389385,1.004037836,1.056929429,1.176076357,1.210005558,
0.4243558,0.463306069,0.596317395,0.63853533,0.755371584,0.809136003,0.89496858,0.982081132,1.038221734,1.157649271,1.191578472,
0.409502103,0.447170487,0.576857057,0.619007594,0.730420925,0.783480684,0.876952899,0.963946054,1.022883517,1.142242698,1.176171899,
0.392814206,0.430627493,0.557802767,0.600494607,0.710468423,0.766504347,0.865362273,0.951723734,1.011578767,1.129648735,1.163577936,
0.377242677,0.415965442,0.542347041,0.586694323,0.696757358,0.756646581,0.857143045,0.942006218,1.001758162,1.117859724,1.151788925,
0.364138237,0.403565479,0.52996295,0.576521138,0.686358473,0.749898292,0.849459337,0.932042599,0.991552205,1.105554655,1.139483856,
0.353736242,0.392818104,0.519245191,0.568103823,0.676963982,0.743588366,0.840375373,0.919995542,0.979827989,1.09214521,1.126074411,
0.345572445,0.382810143,0.508823123,0.559699199,0.666729185,0.735496831,0.828006937,0.904543893,0.966101966,1.077740923,1.111670124,
0.338124804,0.372469531,0.497300363,0.549502425,0.653814465,0.723424797,0.810954174,0.886019864,0.951327637,1.063401745,1.097330946,
0.326965462,0.360894663,0.483704531,0.536340164,0.637539279,0.707259893,0.791171035,0.868348447,0.938213929,1.050813949,1.085498486,
0.314382195,0.348311396,0.468912287,0.52169381,0.620606719,0.691343143,0.773959137,0.855899629,0.928537489,1.040681167,1.07567036,
0.302073413,0.336002614,0.455047962,0.508518629,0.606284935,0.679337154,0.76141177,0.848501554,0.921472048,1.03216237,1.066929111,
0.290983869,0.32491307,0.443155802,0.497991439,0.595035349,0.671031718,0.752175609,0.843943303,0.915556651,1.024148055,1.058450165,
0.281106706,0.315243047,0.433093341,0.489731019,0.585945169,0.665030404,0.744675979,0.840562879,0.909768794,1.015882125,1.049811326,
0.27205642,0.306793209,0.424344593,0.482988468,0.578092006,0.660186244,0.737862002,0.837300134,0.903380811,1.006881344,1.040810545,
0.265298069,0.29922727,0.416383363,0.477064358,0.570758928,0.655639057,0.730973322,0.833296506,0.895705693,0.99683318,1.030786917,
0.258226787,0.292155988,0.408712376,0.47130438,0.563310353,0.650586017,0.723268555,0.8276082,0.88596046,0.98563054,1.020498617,
0.251089845,0.28511938,0.400787081,0.4649677,0.555018135,0.644047494,0.713818677,0.819099879,0.873348927,0.973580936,1.010066692,
0.242769659,0.277530206,0.391921557,0.45709344,0.544942836,0.634780317,0.701534908,0.806897665,0.85769999,0.961747689,1.000361034,
0.233735679,0.268743719,0.381410744,0.446733686,0.532299549,0.622038004,0.686153987,0.79202281,0.840758314,0.95192727,0.992010619,
0.223856924,0.258595941,0.369314384,0.434191527,0.51786294,0.607572068,0.669998007,0.7782303,0.825915782,0.945448049,0.985560698,
0.213644775,0.247914634,0.3570001,0.421636404,0.504135317,0.594885203,0.65627939,0.76831591,0.814842731,0.941978289,0.980732242,
0.203819317,0.237801032,0.345857216,0.410935939,0.492686724,0.585420844,0.645722477,0.761906902,0.806704651,0.940355066,0.976869728,
0.194784228,0.228821097,0.336308832,0.402437333,0.483196777,0.578596071,0.637452762,0.757657198,0.800247034,0.939546365,0.973475566,
0.186626092,0.221053423,0.32817197,0.3957322,0.470229833,0.573492713,0.630567083,0.754575633,0.794644693,0.936332888,0.970262089,
0.179276526,0.214362764,0.321118061,0.390315379,0.457825111,0.569427466,0.624466441,0.752064872,0.789416974,0.933123926,0.967053127,
0.172616291,0.208557684,0.314849472,0.38577597,0.445688484,0.565946442,0.618772972,0.749745857,0.784257731,0.92977984,0.963709041,
0.166519429,0.20344944,0.309130128,0.381803941,0.429808692,0.56273406,0.613228326,0.744999076,0.778928277,0.926144344,0.960073545,
0.160866091,0.198864606,0.303771741,0.378155081,0.412529777,0.55953813,0.607623429,0.739257243,0.773186444,0.921980489,0.95590969,
0.155539239,0.194635833,0.279509729,0.374607471,0.408536672,0.556104833,0.601740172,0.732783035,0.766712236,0.916834256,0.950763457,
0.150404219,0.190568468,0.252595565,0.370893278,0.404822479,0.552079483,0.595260437,0.725031589,0.75896079,0.90961006,0.943539261,
0.145222965,0.186308048,0.223289053,0.36647087,0.400400071,0.546657508,0.587437742,0.714673552,0.748602753,0.896599267,0.930528468,
0.107546788,0.17959848,0.213527681,0.357372517,0.391301718,0.5335652,0.572314095,0.691600778,0.725529979,0.849912282,0.883841483};


/*---------For delay discharge of SCR-----*/
 

/* int FirstEnPWMFlag = 1;  *//*First Enable PWM*/

int NPCautFlag = 0;

int NPZROhead_A1 = 0;
int NPZROtail_A1 = 0;
int NPZROhead_A2 = 0;
int NPZROtail_A2 = 0;

int NPZROhead_B1 = 0;
int NPZROtail_B1 = 0;
int NPZROhead_B2 = 0;
int NPZROtail_B2 = 0;

int NPZROhead_C1 = 0;
int NPZROtail_C1 = 0;
int NPZROhead_C2 = 0;
int NPZROtail_C2 = 0;

int NPPRDhead_A1 = 0;
int NPPRDtail_A1 = 0;
int NPPRDhead_A2 = 0;
int NPPRDtail_A2 = 0;

int NPPRDhead_B1 = 0;
int NPPRDtail_B1 = 0;
int NPPRDhead_B2 = 0;
int NPPRDtail_B2 = 0;

int NPPRDhead_C1 = 0;
int NPPRDtail_C1 = 0;
int NPPRDhead_C2 = 0;
int NPPRDtail_C2 = 0;

int NPjumpA = 0;
int NPjumpB = 0;
int NPjumpC = 0;

int PNjumpA = 0;
int PNjumpB = 0;
int PNjumpC = 0;

int EnablePWMPre = 0;

/*for vvvf1 Hysteris*/
/* int vvvf1IncreFlag = 1; */

double Freq_vsi = 0;
double VFGamaStart = 0.26179939;/*/0.26179939=pi/12*/

int testflag1 = 0;  /*  just for test,1,2,4,8 for four cases */
int changeTsSHEFLAG = 0;

int testflag2 = 0;

double VFGamatemp = 0.01;

/* =============Fixed Gama Region for SVM2SHE=======*/
double deltVFGama = 0.01;

double VFGamatemp1 = 0;/*From VME set*/
double VFGamatemp2 = 0;/*From VME set*/

double VFGamaSHEReady = 0.01;

 
int EnablePWM = 1;/* ePWMflag: disable=0 ; enable=1*/

long int SCRDisCharge_CNT = 0; /*newSCR*/

/*50us*(150M/16) = 468.75*/
long int SCRDisCharge_Time = 6000;

int SCRDisChargeStartFlag = 0;

double T1PRHalfPre = 7813;/*SCR discharge*/

int counter  = 0;

int VMEConnectOKCnt2 = 0;/*delete*/

/*===================Change Pulse Num Starts===================*/

/*ratiotest*/

int tempi;
double Prdf1,TsGama;
double testFlag = 0;
/* double VFGama_Pre = 0.01;  */
double CMPA[6] = {0,0,0,0,0,0};
double CMPAForMinPulse[6] = {0,0,0,0,0,0};  /*  上次采样的比较值，用于SVM和SHE最小脉宽 */
double CMPAForMinPulse2[6] = {0,0,0,0,0,0};  /*  上上次采样得到的比较值，用于SHEPWM最小脉宽检测 */
double AngTb[6][6][22];/*temp*/

const double SHE_TEST[] = 
{
0.785398163397
};

const double * TbStartPointerTest;

double GamaTb = 0;

double PointerTtest;
double VFGamaA = 0;
double VFGamaC=0;

int MinPulse = 938;/*=T1PRHalf;*/

/*For SHEPWM hold on -- when shut down pwm during SHEPWM mode*/

double spdRef = 0;  /*????????------??????,??15Hz ?? 50Hz  (???3.333333)*/
double spdCom = 0;  /*????????*/
int ExacTim  = 128;

/***************** SVPWM START ************************************************************/
/*tb*/
double t1,t2,t3;
void PWM_Prepare(void);
double t2N;/*test  t2NS,t2NB,*/
double ta0=0,tb0=0,tc0=0,ta=0,tb=0,tc=0;

/*All N-type*/
/* 改用VSR查表20150115*/
const double * NPtimeTable[6][6][3]={ /*  epwm12,epwm34,epwm56 */
	              {/* Sector=0 */
                 &t2,&t3,&t1,/* Region=0 */
                 &t3,&t1,&t2,/* Region=1 */
                 &t1,&t3,&t2,/* Region=2 */
                 &t2,&t1,&t3,/* Region=3 */
                 &t1,&t2,&t3,/* Region=4 */
                 &t1,&t2,&t3 /* Region=5 */
                  },
                  
                 {/* Sector=1 */
              	  &t1,&t3,&t2,/* Region=0 */
                  &t3,&t2,&t1,/* Region=1 */
                  &t1,&t2,&t3,/* Region=2 */
                  &t3,&t1,&t2,/* Region=3 */
                  &t2,&t1,&t3,/* Region=4 */
                  &t2,&t1,&t3 /* Region=5 */
                  },
                  
                  {/* Sector=2 */
                  &t1,&t2,&t3, 
                  &t2,&t3,&t1,
                  &t2,&t1,&t3,
                  &t3,&t2,&t1,
                  &t3,&t1,&t2, 
                  &t3,&t1,&t2 
                  },
                  
                  {/* Sector=3 */
                   &t2,&t1,&t3,
                   &t1,&t3,&t2,
                   &t3,&t1,&t2,
                   &t2,&t3,&t1,
                   &t3,&t2,&t1,
                   &t3,&t2,&t1
                   },
                   
                 {/* Sector=4 */
              	  &t3,&t1,&t2,
                  &t1,&t2,&t3,
                  &t3,&t2,&t1,
                  &t1,&t3,&t2,
                  &t2,&t3,&t1,
                  &t2,&t3,&t1
                  }, 
                  
                 {/* Sector=5 */
                 &t3,&t2,&t1,
                 &t2,&t1,&t3,
                 &t2,&t3,&t1,
                 &t1,&t2,&t3,
                 &t1,&t3,&t2,
                 &t1,&t3,&t2
                 }
                 };            
/*  All of this tables are corrected by TLC at 20090901 YZG ActTb is N-type, but the CMPR is not.   */
/*  FOR FPGA  */

const short ActTb_EPwm1[6][6][4] = {     /*  ZRO + CAU + PRD + CAD */
{2,3,1,3, 2,3,1,3, 2,3,1,3,	2,3,1,3, 2,3,1,3, 2,3,1,3,},/* Sector=0    // 参考EPWM3的 Sector2 */
{2,0,2,0, 2,3,1,3, 2,0,2,0, 2,3,1,3, 2,0,2,0, 2,3,1,3,},/* Sector=1   // 参考EPWM3的 Sector3 */
{2,0,2,0, 2,0,2,0, 2,0,2,0, 2,0,2,0, 2,0,2,0, 2,0,2,0,},/* Sector=2   // 参考EPWM3的 Sector4 */
{2,0,2,0, 2,0,2,0, 2,0,2,0, 2,0,2,0, 2,0,2,0, 2,0,2,0,},/* Sector=3   // 参考EPWM3的 Sector5 */
{2,3,1,3, 2,0,2,0, 2,3,1,3, 2,0,2,0, 2,3,1,3, 2,0,2,0,},/* Sector=4   // 参考EPWM3的 Sector0 */
{2,3,1,3, 2,3,1,3, 2,3,1,3, 2,3,1,3, 2,3,1,3, 2,3,1,3,},/* Sector=5   // 参考EPWM3的 Sector1 */
};
/* Reg=0      1        2        3         4        5 */
const short ActTb_EPwm2[6][6][4] = {    /* epwm2 */
{1,0,1,0, 1,0,1,0, 1,0,1,0, 1,0,1,0, 1,0,1,0, 1,0,1,0,},/* Sector=0 */
{2,3,1,3, 1,0,1,0, 2,3,1,3,	1,0,1,0, 2,3,1,3, 1,0,1,0,},/* Sector=1 */
{2,3,1,3, 2,3,1,3, 2,3,1,3, 2,3,1,3, 2,3,1,3, 2,3,1,3,},/* Sector=2 */
{2,3,1,3, 2,3,1,3, 2,3,1,3, 2,3,1,3, 2,3,1,3, 2,3,1,3,},/* Sector=3 */
{1,0,1,0, 2,3,1,3, 1,0,1,0, 2,3,1,3, 1,0,1,0, 2,3,1,3,},/* Sector=4 */
{1,0,1,0, 1,0,1,0, 1,0,1,0, 1,0,1,0, 1,0,1,0, 1,0,1,0,},/* Sector=5 */
};
const short ActTb_EPwm3[6][6][4] = {   /*  epwm3 */
{2,3,1,3, 2,0,2,0, 2,3,1,3, 2,0,2,0, 2,3,1,3, 2,0,2,0,},	
{2,3,1,3, 2,3,1,3, 2,3,1,3, 2,3,1,3, 2,3,1,3, 2,3,1,3,},
{2,3,1,3, 2,3,1,3, 2,3,1,3, 2,3,1,3, 2,3,1,3, 2,3,1,3,},
{2,0,2,0, 2,3,1,3, 2,0,2,0, 2,3,1,3, 2,0,2,0, 2,3,1,3,},
{2,0,2,0, 2,0,2,0, 2,0,2,0, 2,0,2,0, 2,0,2,0, 2,0,2,0,},
{2,0,2,0, 2,0,2,0, 2,0,2,0, 2,0,2,0, 2,0,2,0, 2,0,2,0,},
}; 
const short ActTb_EPwm4[6][6][4] = {   /*  epwm4 */
{1,0,1,0, 2,3,1,3, 1,0,1,0, 2,3,1,3, 1,0,1,0, 2,3,1,3,},	
{1,0,1,0, 1,0,1,0, 1,0,1,0,	1,0,1,0, 1,0,1,0, 1,0,1,0,},
{1,0,1,0, 1,0,1,0, 1,0,1,0, 1,0,1,0, 1,0,1,0, 1,0,1,0,},
{2,3,1,3, 1,0,1,0, 2,3,1,3, 1,0,1,0, 2,3,1,3, 1,0,1,0,},
{2,3,1,3, 2,3,1,3, 2,3,1,3, 2,3,1,3, 2,3,1,3, 2,3,1,3,},
{2,3,1,3, 2,3,1,3, 2,3,1,3, 2,3,1,3, 2,3,1,3, 2,3,1,3,},
};
const short ActTb_EPwm5[6][6][4] = {  /*  epwm5 */
{2,0,2,0, 2,0,2,0, 2,0,2,0, 2,0,2,0, 2,0,2,0, 2,0,2,0,},	
{2,0,2,0, 2,0,2,0, 2,0,2,0,	2,0,2,0, 2,0,2,0, 2,0,2,0,},
{2,3,1,3, 2,0,2,0, 2,3,1,3, 2,0,2,0, 2,3,1,3, 2,0,2,0,},
{2,3,1,3, 2,3,1,3, 2,3,1,3, 2,3,1,3, 2,3,1,3, 2,3,1,3,},
{2,3,1,3, 2,3,1,3, 2,3,1,3, 2,3,1,3, 2,3,1,3, 2,3,1,3,},
{2,0,2,0, 2,3,1,3, 2,0,2,0, 2,3,1,3, 2,0,2,0, 2,3,1,3,},	
}; 
const short ActTb_EPwm6[6][6][4] = {  /*  epwm6 */
{2,3,1,3, 2,3,1,3, 2,3,1,3, 2,3,1,3, 2,3,1,3, 2,3,1,3,},	
{2,3,1,3, 2,3,1,3, 2,3,1,3,	2,3,1,3, 2,3,1,3, 2,3,1,3,},
{1,0,1,0, 2,3,1,3, 1,0,1,0, 2,3,1,3, 1,0,1,0, 2,3,1,3,},
{1,0,1,0, 1,0,1,0, 1,0,1,0, 1,0,1,0, 1,0,1,0, 1,0,1,0,},
{1,0,1,0, 1,0,1,0, 1,0,1,0, 1,0,1,0, 1,0,1,0, 1,0,1,0,},
{2,3,1,3, 1,0,1,0, 2,3,1,3, 1,0,1,0, 2,3,1,3, 1,0,1,0,},
}; 		
/*
const short ActTb_EPwm1[6][6][4] = {     // ZRO + CAU + PRD + CAD     o-p:{2,1,1,2}   n-o:{2,2,2,2}
{2,1,1,2, 2,1,1,2, 2,1,1,2,	2,1,1,2, 2,1,1,2, 2,1,1,2,},//Sector=0   {o-p,o-p,o-p,o-p,o-p,o-p} // 参考EPWM3的 Sector2
{2,2,2,2, 2,1,1,2, 2,2,2,2, 2,1,1,2, 2,2,2,2, 2,1,1,2,},//Sector=1   {n-o,o-p,n-o,o-p,n-o,o-p}// 参考EPWM3的 Sector3
{2,2,2,2, 2,2,2,2, 2,2,2,2, 2,2,2,2, 2,2,2,2, 2,2,2,2,},//Sector=2   {n-o,n-o,n-o,n-o,n-o,n-o}// 参考EPWM3的 Sector4
{2,2,2,2, 2,2,2,2, 2,2,2,2, 2,2,2,2, 2,2,2,2, 2,2,2,2,},//Sector=3   {n-o,n-o,n-o,n-o,n-o,n-o}// 参考EPWM3的 Sector5
{2,1,1,2, 2,2,2,2, 2,1,1,2, 2,2,2,2, 2,1,1,2, 2,2,2,2,},//Sector=4   {o-p,n-o,o-p,n-o,o-p,n-o}// 参考EPWM3的 Sector0
{2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2,},//Sector=5   {o-p,o-p,o-p,o-p,o-p,o-p}// 参考EPWM3的 Sector1
};
//Reg=0      1        2        3         4        5
const short ActTb_EPwm2[6][6][4] = {    //epwm2                      o-p:{1,1,1,1}   n-o:{2,1,1,2}
{1,1,1,1, 1,1,1,1, 1,1,1,1, 1,1,1,1, 1,1,1,1, 1,1,1,1,},//Sector=0   {o-p,o-p,o-p,o-p,o-p,o-p}
{2,1,1,2, 1,1,1,1, 2,1,1,2,	1,1,1,1, 2,1,1,2, 1,1,1,1,},//Sector=1   {n-o,o-p,n-o,o-p,n-o,o-p}
{2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2,},//Sector=2   {n-o,n-o,n-o,n-o,n-o,n-o}
{2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2,},//Sector=3   {n-o,n-o,n-o,n-o,n-o,n-o}
{1,1,1,1, 2,1,1,2, 1,1,1,1, 2,1,1,2, 1,1,1,1, 2,1,1,2,},//Sector=4   {o-p,n-o,o-p,n-o,o-p,n-o}
{1,1,1,1, 1,1,1,1, 1,1,1,1, 1,1,1,1, 1,1,1,1, 1,1,1,1,},//Sector=5   {o-p,o-p,o-p,o-p,o-p,o-p}
};
const short ActTb_EPwm3[6][6][4] = {   // epwm3                      o-p:{2,1,1,2}   n-o:{2,2,2,2}
{2,1,1,2, 2,2,2,2, 2,1,1,2, 2,2,2,2, 2,1,1,2, 2,2,2,2,},//           {o-p,n-o,o-p,n-o,o-p,n-o}
{2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2,},//           {o-p,o-p,o-p,o-p,o-p,o-p}
{2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2,},//           {o-p,o-p,o-p,o-p,o-p,o-p}
{2,2,2,2, 2,1,1,2, 2,2,2,2, 2,1,1,2, 2,2,2,2, 2,1,1,2,},//           {n-o,o-p,n-o,o-p,n-o,o-p}
{2,2,2,2, 2,2,2,2, 2,2,2,2, 2,2,2,2, 2,2,2,2, 2,2,2,2,},//           {n-o,n-o,n-o,n-o,n-o,n-o}
{2,2,2,2, 2,2,2,2, 2,2,2,2, 2,2,2,2, 2,2,2,2, 2,2,2,2,},//           {n-o,n-o,n-o,n-o,n-o,n-o}
}; 
const short ActTb_EPwm4[6][6][4] = {   // epwm4                      o-p:{1,1,1,1}   n-o:{2,1,1,2}
{1,1,1,1, 2,1,1,2, 1,1,1,1, 2,1,1,2, 1,1,1,1, 2,1,1,2,},//           {o-p,n-o,o-p,n-o,o-p,n-o}
{1,1,1,1, 1,1,1,1, 1,1,1,1, 1,1,1,1, 1,1,1,1, 1,1,1,1,},//           {o-p,o-p,o-p,o-p,o-p,o-p}
{1,1,1,1, 1,1,1,1, 1,1,1,1, 1,1,1,1, 1,1,1,1, 1,1,1,1,},//           {o-p,o-p,o-p,o-p,o-p,o-p}
{2,1,1,2, 1,1,1,1, 2,1,1,2,	1,1,1,1, 2,1,1,2, 1,1,1,1,},//           {n-o,o-p,n-o,o-p,n-o,o-p}
{2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2,},//           {n-o,n-o,n-o,n-o,n-o,n-o}
{2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2,},//           {n-o,n-o,n-o,n-o,n-o,n-o}
};
const short ActTb_EPwm5[6][6][4] = {  // epwm5                       o-p:{2,1,1,2}   n-o:{2,2,2,2}
{2,2,2,2, 2,2,2,2, 2,2,2,2, 2,2,2,2, 2,2,2,2, 2,2,2,2,},//           {n-o,n-o,n-o,n-o,n-o,n-o}
{2,2,2,2, 2,2,2,2, 2,2,2,2,	2,2,2,2, 2,2,2,2, 2,2,2,2,},//           {n-o,n-o,n-o,n-o,n-o,n-o}
{2,1,1,2, 2,2,2,2, 2,1,1,2, 2,2,2,2, 2,1,1,2, 2,2,2,2,},//           {o-p,n-o,o-p,n-o,o-p,n-o}
{2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2,},//           {o-p,o-p,o-p,o-p,o-p,o-p}
{2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2,},//           {o-p,o-p,o-p,o-p,o-p,o-p}
{2,2,2,2, 2,1,1,2, 2,2,2,2, 2,1,1,2, 2,2,2,2, 2,1,1,2,},//           {n-o,o-p,n-o,o-p,n-o,o-p}
}; 
const short ActTb_EPwm6[6][6][4] = {  // epwm6                       o-p:{1,1,1,1}   n-o:{2,1,1,2}
{2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2,},//           {n-o,n-o,n-o,n-o,n-o,n-o}
{2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2, 2,1,1,2,},//           {n-o,n-o,n-o,n-o,n-o,n-o}
{1,1,1,1, 2,1,1,2, 1,1,1,1, 2,1,1,2, 1,1,1,1, 2,1,1,2,},//           {o-p,n-o,o-p,n-o,o-p,n-o}
{1,1,1,1, 1,1,1,1, 1,1,1,1, 1,1,1,1, 1,1,1,1, 1,1,1,1,},//           {o-p,o-p,o-p,o-p,o-p,o-p}
{1,1,1,1, 1,1,1,1, 1,1,1,1, 1,1,1,1, 1,1,1,1, 1,1,1,1,},//           {o-p,o-p,o-p,o-p,o-p,o-p}
{2,1,1,2, 1,1,1,1, 2,1,1,2,	1,1,1,1, 2,1,1,2, 1,1,1,1,},//           {n-o,o-p,n-o,o-p,n-o,o-p}
}; 		
*/
/******************SVPWM END***********************/

/****************For SVPWM-KV******************/

int ma_index;

/*att3  SVM SHE共用*/
/* int HalfGama_TotalNum = 0;
int Gama_TotalNum  = 0;

int Gama_TotalNum_Pre = 0;  */

double 	f = 30;/* MOPEN 30;  */

/* double vvvf1 = 0.0; */ /*tempset  起始频率 0.01;test*/
double vvvf1Pre = 0.0;
/*误差范围：max(0.5*Ts2*vvvf1_Up_Rate，0.5*Ts2*vvvf1_Dn_Rate) = 0.5*(1/12k)*10*/

double VFVolt,Ts_Pre;
double VFGama = 0.01,VFGama_pre=0;  /*初始化*/
double vfk = 2;/*tempset 2;0.5;test ratio test  3* 90 = 270;*/

double Gama_SVM_Real= 0;

double Gama_SVM_Used=0;
double jp_ta,jp_tb,jp_tc;
double t1C,t2C,t3C;
/* int PWM4Cnt = 1;  *//*1;pwmcnt*/

const double * JpStart_NPtimeTable[6][3]=    /* SVPWML */
{
{&t1,&t2,&t3},/* Sector1	*/
{&t2,&t1,&t3},/*Sector2*/
{&t3,&t1,&t2},/*Sector3*/
{&t3,&t2,&t1},/*Sector4*/
{&t2,&t3,&t1},/*Sector5*/
{&t1,&t3,&t2},/*Sector6*/
};

const double * JpStart_NPtimeTableC[6][3]=    /* SVPWML */
{
{&t1C,&t2C,&t3C},/*Sector1	*/
{&t2C,&t1C,&t3C},/*Sector2*/
{&t3C,&t1C,&t2C},/*Sector3*/
{&t3C,&t2C,&t1C},/*Sector4*/
{&t2C,&t3C,&t1C},/*Sector5*/
{&t1C,&t3C,&t2C},/*Sector6*/
};

/*
const short JapStart_ActTb_EPwm1[4][2]= // PWM1,3,5
{
{2,0},//NO
{2,3},//OP
{1,3},//PO
{2,0},//ON
};

const short JapStart_ActTb_EPwm2[4][2]= // PWM2,4,6
{
{2,3},//NO
{1,0},//OP
{1,0},//PO
{1,3},//ON
};    */
const short JapStart_ActTb_EPwm1[4][2]= /*  PWM1,3,5 */
{
{2,2},/* NO */
{2,1},/* OP */
{1,2},/* PO */
{2,2},/* ON */
};

const short JapStart_ActTb_EPwm2[4][2]= /*  PWM2,4,6 */
{
{2,1},/* NO */
{1,1},/* OP */
{1,1},/* PO */
{1,2},/* ON */
};
double jp_tbtemp=0;

int ZRO[6]={2,1,2,1,2,1},CAU[6]={0,0,0,0,0,0},PRD[6]={2,1,2,1,2,1},CAD[6]={0,0,0,0,0,0};

int IntSel = 0; /*代表硬件ET模块中断类型，0-ZRO，1-PRD*/

int PRDForMinPulse[6] = {0,0,0,0,0,0};
                
int CADForMinPulse[6] = {0,0,0,0,0,0};

int ZROForMinPulse[6] = {0,0,0,0,0,0};
            
int CAUForMinPulse[6] = {0,0,0,0,0,0};

int SwitchCriteria[6] = {0,0,0,0,0,0};  /*  SHE切换到SVM的判据变量，1为可切换 */

double MinPulseWidthCntPrevious = (SVMClkFreq * MinPulseDuration);   /*  最小脉宽计数器，记录上次采样周期对应最小脉宽 */
double MinPulseWidthCntPresent = (SVMClkFreq * MinPulseDuration);    /*  最小脉宽计数器，记录本次采样周期对应最小脉宽 */
//int i = 0;
double T1PRHalfForMinPulse = T1PRHalfSVM;
int MinPulseHandleFlag = 0;  /*  0表示没有修改动作寄存器数值，1表示修改 */


/* for Voltage balance*/
double Gama_SVM_DeltT;
double NeuVoltCtl_sum;
double Kp_uz = -0.005;/*for VSI side 20100321*/
double Ki_uz= -0.0500000000001;/*TLC double Ki_uz= -60*Ts/2;/TLC*/
double Vdc1MinuVdc2 = 0;
double NeuVoltCtl_deltT = 0;

int sign_ia = 0, sign_ib = 0, sign_ic = 0;

int Nostep=0;/*VBC*/

/* double Freq = 0;  //fundamental frequency */

/*Reg*/
/*0    1     2   3    4    5 */
const short Tbt1t2t3[6][6] = {   
{613, 461, 163, 416, 136, 146,},/*Sector=0*/
{263, 631, 236, 361, 326, 316,},/*Sector=1*/
{235, 623, 325, 632, 352, 362,},/*Sector=2*/
{425, 253, 452, 523, 542, 532,},/*Sector=3*/
{451, 245, 541, 254, 514, 524,},/*Sector=4*/
{641, 415, 614, 145, 164, 154,},/*Sector=5	  */    
};

int NPChange=0;/*svmtlc  初始化，该量用于VBC和Minimum_Pulse_TLC处理*/

double Kvk1 = 0;  /* Kvk1存放上一次调制比 */

/* int Change_SL=0; */
int Change_SL_Store=0;/* 初始化与tlc的程序保持一致*/
double vvvf1Start = 0.01;/*0.01;*//*tempset*/
int VBC_test=1;
 

/*shutdow SHEPWM*/

/*TEMP 测试SHE是否转入了SVM，进入SVM该数为0，进入SHE该数为1*/
int SHE2SVFLAG = 0;
/*从SVM到SHE,如果该时刻切SHE合适，则SHEReady=1;不合适SHEReady = 0;*/
/* int SHEReady = 0;  */

double MinPulseTime = 1.5e-4;/*150us*/
int SVM_PRD[6],SVM_CAD[6];
int SHEReadyFLAG[6];

double GamaInterDelta=0, VFGamaPre = 0;
int 	vrefDirFlag = 0;

short 	errcnt=0;

//struct PWMdataStruct PWMdata_INV1; 
//struct PWMdataStruct PWMdata_INV2;
//struct PWMdataStruct PWMdata_REC1; 
//struct PWMdataStruct PWMdata_REC2;
